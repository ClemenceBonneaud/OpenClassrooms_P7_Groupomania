{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"publication\"\n};\nconst _hoisted_2 = {\n  class: \"bloc\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Titre\", -1\n/* HOISTED */\n);\n\nconst _hoisted_4 = {\n  key: 0,\n  class: \"formMessage\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"formMessage\",\n  id: \"articleMessage\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"errorMessage\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"bouton bouton--disabled\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_HeaderHome = _resolveComponent(\"HeaderHome\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_HeaderHome), _createElementVNode(\"h1\", null, _toDisplayString($data.titre), 1\n  /* TEXT */\n  ), _createCommentVNode(\" Formulaire \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"form\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.title = $event),\n    type: \"text\",\n    onChange: _cache[1] || (_cache[1] = $event => $options.checkTitle())\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $data.title]]), _createCommentVNode(\" Message qui apparaît si le champ est mal rempli \"), $data.titleDisplayed ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, \" Veuillez écrire un titre \")) : _createCommentVNode(\"v-if\", true), _withDirectives(_createElementVNode(\"textarea\", {\n    placeholder: \"Votre article\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.content = $event),\n    onChange: _cache[3] || (_cache[3] = $event => $options.checkContent())\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $data.content]]), $data.contentDisplayed ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, \" Veuillez écrire un article de moins de 255 caractères \")) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" Message d'erreur en cas d'erreur côté serveur \"), $data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, \" Oups ! Il semble que \" + _toDisplayString($data.errorMessage), 1\n  /* TEXT */\n  )) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Bouton désactivé \"), !$options.validatedFields() ? (_openBlock(), _createElementBlock(\"button\", _hoisted_7, \" Publier \")) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Bouton activé \"), $options.validatedFields() ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 2,\n    class: \"bouton\",\n    onClick: _cache[4] || (_cache[4] = $event => $options.publishArticle())\n  }, \" Publier \")) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"mappings":";;AAKOA,OAAK,EAAC;;;AAMJA,OAAK,EAAC;;;gCAEPC,oBAAoB,OAApB,EAAoB,IAApB,EAAO,OAAP,EAAY;AAAA;AAAZ;;;;AAGGD,OAAK,EAAC;;;;AASNA,OAAK,EAAC;AAAcE,IAAE,EAAC;;;;AAMLF,OAAK,EAAC;;;;AAKKA,OAAK,EAAC;;;;;uBA/B5CG,oBAwCM,KAxCN,cAwCM,CAvCJC,aAAcC,qBAAd,CAuCI,EArCJJ,oBAAoB,IAApB,EAAoB,IAApB,EAAoBK,iBAAbC,WAAa,CAApB,EAAY;AAAA;AAAZ,GAqCI,EAnCJC,mCAmCI,EAlCJP,oBAiCM,KAjCN,cAiCM,CAhCJA,oBAgBO,MAhBP,EAgBO,IAhBP,EAgBO,CAfLQ,UAeK,kBAdLR,oBAA4D,OAA5D,EAA4D;+DAA5CM,cAAKG,OAAuC;AAArCC,QAAI,EAAC,MAAgC;AAAxBC,YAAM,sCAAEC,qBAAF;AAAkB,GAA5D;;AAAA,oBAAgBN,cAcX,EAbLC,wEAaK,EAZwBD,sCAA7BJ,oBAEI,GAFJ,cAA6C,4BAA7C,sCAYK,kBARLF,oBAIY,UAJZ,EAIY;AAHVa,eAAW,EAAC,eAGF;+DAFDP,gBAAOG,OAEN;AADTE,YAAM,sCAAEC,uBAAF;AACG,GAJZ;;AAAA,oBAEWN,gBAMN,EAH4CA,wCAAjDJ,oBAEI,GAFJ,cAAmE,yDAAnE,sCAGK,CAhBP,CAgCI,EAdJK,sEAcI,EAbKD,oCAATJ,oBAEI,GAFJ,cAA4C,2BACrBG,iBAAGC,kBAAH,CADvB,EACsC;AAAA;AADtC,wCAaI,EATJC,yCASI,GARWK,4CAAfV,oBAES,QAFT,cAAkE,WAAlE,sCAQI,EAJJK,sCAII,EAHUK,4CAAdV,oBAES,QAFT,EAES;UAAA;AAFwBH,SAAK,EAAC,QAE9B;AAFwCe,WAAK,sCAAEF,yBAAF;AAE7C,GAFT,EAA0E,WAA1E,sCAGI,CAjCN,CAkCI,CAxCN","names":["class","_createElementVNode","id","_createElementBlock","_createVNode","_component_HeaderHome","_toDisplayString","$data","_createCommentVNode","_hoisted_3","$event","type","onChange","$options","placeholder","onClick"],"sourceRoot":"","sources":["/Users/clemencebonneaud/Desktop/Dev/OpenClassrooms/Cours/OC_P7/code/frontend/groupomania-v1.0/src/views/PublicationView.vue"],"sourcesContent":["<!-- ////////////////////////////////////////////////// -->\n<!--                      TEMPLATE                      -->\n<!-- ////////////////////////////////////////////////// -->\n\n<template>\n  <div class=\"publication\">\n    <HeaderHome />\n\n    <h1>{{ titre }}</h1>\n\n    <!-- Formulaire -->\n    <div class=\"bloc\">\n      <form>\n        <label>Titre</label>\n        <input v-model=\"title\" type=\"text\" @change=\"checkTitle()\" />\n        <!-- Message qui apparaît si le champ est mal rempli -->\n        <p class=\"formMessage\" v-if=\"titleDisplayed\">\n          Veuillez écrire un titre\n        </p>\n\n        <textarea\n          placeholder=\"Votre article\"\n          v-model=\"content\"\n          @change=\"checkContent()\"\n        ></textarea>\n        <p class=\"formMessage\" id=\"articleMessage\" v-if=\"contentDisplayed\">\n          Veuillez écrire un article de moins de 255 caractères\n        </p>\n      </form>\n\n      <!-- Message d'erreur en cas d'erreur côté serveur -->\n      <p v-if=\"errorMessage\" class=\"errorMessage\">\n        Oups ! Il semble que {{ errorMessage }}\n      </p>\n\n      <!-- Bouton désactivé -->\n      <button v-if=\"!validatedFields()\" class=\"bouton bouton--disabled\">\n        Publier\n      </button>\n\n      <!-- Bouton activé -->\n      <button v-if=\"validatedFields()\" class=\"bouton\" @click=\"publishArticle()\">\n        Publier\n      </button>\n    </div>\n  </div>\n</template>\n\n<!-- ////////////////////////////////////////////////// -->\n<!--                       SCRIPT                       -->\n<!-- ////////////////////////////////////////////////// -->\n\n<script>\nimport HeaderHome from \"@/components/HeaderHome.vue\";\n\n// Axios\nconst axios = require(\"axios\");\nconst instance = axios.create({\n  baseURL: \"http://localhost:3000/api/\",\n});\n\nexport default {\n  name: \"PublicationView\",\n  path: \"/publication\",\n  props: [\"\"],\n  data() {\n    return {\n      titre: \"Publier un article\",\n      title: \"\",\n      content: \"\",\n      titleDisplayed: false,\n      contentDisplayed: false,\n      errorMessage: null,\n    };\n  },\n  methods: {\n    // Vérification présence titre\n    checkTitle: function () {\n      if (this.title != \"\") {\n        this.titleDisplayed = false;\n      } else {\n        this.titleDisplayed = true;\n      }\n    },\n\n    // Vérification présence article\n    checkContent: function () {\n      if (this.content != \"\") {\n        this.contentDisplayed = false;\n      } else if (this.content.length >= 255){\n        this.contentDisplayed = true;\n      } else {\n        this.contentDisplayed = true;\n      }\n    },\n\n    // Vérification de tous les champs et gestion activation/désactivation du bouton \"publier\"\n    validatedFields: function () {\n      if (this.title != \"\" && this.content != \"\") {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    publishArticle: function () {\n      let articleInfos = {\n        title: this.title,\n        content: this.content,\n      };\n\n      instance\n        .post(\"article/\", articleInfos, { headers: { 'Authorization': \"bearer \" + this.$store.state.sessionToken } })\n        .then((response) => {\n          console.log(response)\n          this.$router.push(\"/\"); // Redirection vers accueil\n        })\n        .catch((error) => {\n          console.log(error);\n          this.errorMessage = error.response.data.error; // Affichage du message d'erreur\n        });\n    },\n  },\n  components: { HeaderHome },\n};\n</script>\n\n<!-- ////////////////////////////////////////////////// -->\n<!--                       STYLE                        -->\n<!-- ////////////////////////////////////////////////// -->\n\n<style>\n#articleMessage {\n  margin-top: 10px;\n}\n\ntextarea {\n  margin-bottom: 10px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}