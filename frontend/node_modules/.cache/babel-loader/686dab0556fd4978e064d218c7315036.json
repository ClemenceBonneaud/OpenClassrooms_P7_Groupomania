{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"signup\"\n};\nconst _hoisted_2 = {\n  class: \"bloc\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Email\", -1);\n\nconst _hoisted_4 = {\n  key: 0,\n  class: \"formMessage\"\n};\n\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Mot de passe\", -1);\n\nconst _hoisted_6 = {\n  key: 1,\n  class: \"formMessage\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"errorMessage\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  class: \"bouton bouton--disabled\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_HeaderLog = _resolveComponent(\"HeaderLog\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_HeaderLog), _createElementVNode(\"h1\", null, _toDisplayString($data.titre), 1), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"form\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    type: \"email\",\n    onKeyup: _cache[1] || (_cache[1] = $event => $options.analyseEmail())\n  }, null, 544), [[_vModelText, $data.email]]), $data.emailDisplayed ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, \" Veuillez saisir un email valide \")) : _createCommentVNode(\"\", true), _hoisted_5, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.password = $event),\n    type: \"password\",\n    onChange: _cache[3] || (_cache[3] = $event => $options.checkPassword())\n  }, null, 544), [[_vModelText, $data.password]]), $data.passwordDisplayed ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, \" Veuillez saisir un mot de passe \")) : _createCommentVNode(\"\", true)]), $data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, \" Oups ! Il semble que \" + _toDisplayString($data.errorMessage), 1)) : _createCommentVNode(\"\", true), !$options.validatedFields() ? (_openBlock(), _createElementBlock(\"button\", _hoisted_8, \" Se connecter \")) : _createCommentVNode(\"\", true), $options.validatedFields() ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 2,\n    class: \"bouton\",\n    onClick: _cache[4] || (_cache[4] = $event => $options.loginAccount())\n  }, \" Se connecter \")) : _createCommentVNode(\"\", true)])]);\n}","map":{"version":3,"mappings":";;AAKOA,OAAK,EAAC;;;AAOJA,OAAK,EAAC;;;gCAEPC,oBAAoB,OAApB,EAAoB,IAApB,EAAO,OAAP,EAAY,EAAZ;;;;AAGGD,OAAK,EAAC;;;gCAITC,oBAA2B,OAA3B,EAA2B,IAA3B,EAAO,cAAP,EAAmB,EAAnB;;;;AAEGD,OAAK,EAAC;;;;AAMYA,OAAK,EAAC;;;;AAKKA,OAAK,EAAC;;;;;uBA7B5CE,oBAsCM,KAtCN,cAsCM,CApCJC,aAAaC,oBAAb,CAoCI,EAlCJH,oBAAoB,IAApB,EAAoB,IAApB,EAAoBI,iBAAbC,WAAa,CAApB,EAAY,CAAZ,CAkCI,EA/BJL,oBA8BM,KA9BN,cA8BM,CA7BJA,oBAaO,MAbP,EAaO,IAbP,EAaO,CAZLM,UAYK,kBAXLN,oBAA8D,OAA9D,EAA8D;+DAA9CK,cAAKE,OAAyC;AAAvCC,QAAI,EAAC,OAAkC;AAAzBC,WAAK,sCAAEC,uBAAF;AAAoB,GAA9D,6BAAgBL,cAWX,EATwBA,sCAA7BJ,oBAEI,GAFJ,cAA6C,mCAA7C,kCASK,EALLU,UAKK,kBAJLX,oBAAsE,OAAtE,EAAsE;+DAAtDK,iBAAQE,OAA8C;AAA5CC,QAAI,EAAC,UAAuC;AAA3BI,YAAM,sCAAEF,wBAAF;AAAqB,GAAtE,6BAAgBL,iBAIX,EAHwBA,yCAA7BJ,oBAEI,GAFJ,cAAgD,mCAAhD,kCAGK,CAbP,CA6BI,EAbKI,oCAATJ,oBAEI,GAFJ,cAA4C,2BACrBG,iBAAGC,kBAAH,CADvB,EACsC,CADtC,kCAaI,GARWK,4CAAfT,oBAES,QAFT,cAAkE,gBAAlE,kCAQI,EAHUS,4CAAdT,oBAES,QAFT,EAES;UAAA;AAFwBF,SAAK,EAAC,QAE9B;AAFwCc,WAAK,sCAAEH,uBAAF;AAE7C,GAFT,EAAwE,gBAAxE,kCAGI,CA9BN,CA+BI,CAtCN","names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_HeaderLog","_toDisplayString","$data","_hoisted_3","$event","type","onKeyup","$options","_hoisted_5","onChange","onClick"],"sourceRoot":"","sources":["/Users/clemencebonneaud/Desktop/Dev/OpenClassrooms/Cours/OC_P7/code/frontend/groupomania-v1.0/src/views/LoginView.vue"],"sourcesContent":["<!-- ////////////////////////////////////////////////// -->\n<!--                      TEMPLATE                      -->    \n<!-- ////////////////////////////////////////////////// -->\n\n<template>\n  <div class=\"signup\">\n    <!-- Header -->\n    <HeaderLog />\n\n    <h1>{{ titre }}</h1>\n\n    <!-- Formulaire -->\n    <div class=\"bloc\">\n      <form>\n        <label>Email</label>\n        <input v-model=\"email\" type=\"email\" @keyup=\"analyseEmail()\" />\n        <!-- Message qui apparaît si le champ est mal rempli -->\n        <p class=\"formMessage\" v-if=\"emailDisplayed\">\n          Veuillez saisir un email valide\n        </p>\n\n        <label>Mot de passe</label>\n        <input v-model=\"password\" type=\"password\" @change=\"checkPassword()\" />\n        <p class=\"formMessage\" v-if=\"passwordDisplayed\">\n          Veuillez saisir un mot de passe\n        </p>\n      </form>\n\n      <!-- Message d'erreur en cas d'erreur côté serveur -->\n      <p v-if=\"errorMessage\" class=\"errorMessage\">\n        Oups ! Il semble que {{ errorMessage }}\n      </p>\n\n      <!-- Bouton désactivé -->\n      <button v-if=\"!validatedFields()\" class=\"bouton bouton--disabled\">\n        Se connecter\n      </button>\n\n      <!-- Bouton activé -->\n      <button v-if=\"validatedFields()\" class=\"bouton\" @click=\"loginAccount()\">\n        Se connecter\n      </button>\n    </div>\n  </div>\n</template>\n\n<!-- ////////////////////////////////////////////////// -->\n<!--                       SCRIPT                       -->    \n<!-- ////////////////////////////////////////////////// -->\n\n<script>\n// Header\nimport HeaderLog from \"@/components/HeaderLog.vue\";\n\n// Axios\nconst axios = require(\"axios\");\nconst instance = axios.create({\n  baseURL: \"http://localhost:3000/api/\",\n});\n\nexport default {\n  name: \"LoginView\",\n  props: [\"\"],\n  data() {\n    return {\n      titre: \"Se connecter\",\n      email: \"\",\n      password: \"\",\n      emailDisplayed: false,\n      passwordDisplayed: false,\n      errorMessage: null,\n      sessionToken: null,\n    };\n  },\n  methods: {\n    // Vérification Regex + gestion affichage message d'erreur\n    analyseEmail: function () {\n      let regEmail = new RegExp(\"[a-z0-9]+@[a-z]+[.]+[a-z]{2,3}\");\n      let testEmail = regEmail.exec(this.email);\n      if (testEmail) {\n        this.emailDisplayed = false;\n      } else {\n        this.emailDisplayed = true;\n      }\n    },\n\n    // Vérification présence mot de passe et gestion affichage message d'erreur\n    checkPassword: function () {\n      if (this.password != \"\") {\n        this.passwordDisplayed = false;\n      } else {\n        this.passwordDisplayed = true;\n      }\n    },\n\n    // Vérification de tous les champs et gestion activation/désactivation du bouton \"se connecter\"\n    validatedFields: function () {\n      let regEmail = new RegExp(\"[a-z0-9]+@[a-z]+[.]+[a-z]{2,3}\");\n      let testEmail = regEmail.exec(this.email);\n\n      if (testEmail && this.password != \"\") {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    // Envoi API - connection utilisateur déjà existant\n    loginAccount: function () {\n      let userInfos = {\n        email: this.email,\n        password: this.password,\n      };\n\n      instance\n        .post(\"auth/login\", userInfos)\n        .then((response) => {\n          this.$store.state.sessionToken = response.data.token; // Récupération du token dans le state\n          this.$store.state.userId = response.data.userId; // Récupération du userId dans le state\n          this.$router.push(\"/\"); // Redirection vers accueil\n        })\n        .catch((error) => {\n          console.log(error);\n          this.errorMessage = error.response.data.error; // Affichage du message d'erreur\n        });\n    },\n  },\n  components: { HeaderLog },\n};\n</script>\n"]},"metadata":{},"sourceType":"module"}